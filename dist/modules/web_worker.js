class Etalon{constructor(){this.sum3Parameters={value:0,percent:0,name:"Броня+Урон+Шок",commandValue:0,commandPercent:0,calculate:0},this.allParameters={value:0,percent:0,name:"Сумма всех",commandValue:0,commandPercent:0,calculate:0},this.allDamage={value:0,percent:0,name:"Общий урон",commandValue:0,commandPercent:0,calculate:2},this.damagePhisical={value:0,percent:0,name:"Урон (Физич.)",commandValue:0,commandPercent:0,calculate:1},this.damagePoison={value:0,percent:0,name:"Урон (Яд)",commandValue:0,commandPercent:0,calculate:1},this.damageElectricity={value:0,percent:0,name:"Урон (Электр.)",commandValue:0,commandPercent:0,calculate:1},this.damageWater={value:0,percent:0,name:"Урон (Вода)",commandValue:0,commandPercent:0,calculate:1},this.damageFair={value:0,percent:0,name:"Урон (Огонь)",commandValue:0,commandPercent:0,calculate:1},this.damageDead={value:0,percent:0,name:"Урон (Смерть)",commandValue:0,commandPercent:0,calculate:1},this.damageAstral={value:0,percent:0,name:"Урон (Астрал.)",commandValue:0,commandPercent:0,calculate:1},this.initiative={value:0,percent:0,name:"Инициатива",commandValue:0,commandPercent:0,calculate:2},this.accuracy={value:0,percent:0,name:"Точность атаки",commandValue:0,commandPercent:0,calculate:2},this.shock={value:0,percent:0,name:"Шоковая атака",commandValue:0,commandPercent:0,calculate:2},this.antiShock={value:0,percent:0,name:"Устойчивость к шоку",commandValue:0,commandPercent:0,calculate:2},this.generalProtection={value:0,percent:0,name:"Общая защита",commandValue:0,commandPercent:0,calculate:2},this.resistancePhysical={value:0,percent:0,name:"Сопр. (Физич.)",commandValue:0,commandPercent:0,calculate:2},this.poisonResistance={value:0,percent:0,name:"Сопр. (Яд)",commandValue:0,commandPercent:0,calculate:2},this.electricityResistance={value:0,percent:0,name:"Сопр. (Электр.)",commandValue:0,commandPercent:0,calculate:2},this.waterResistance={value:0,percent:0,name:"Сопр. (Вода)",commandValue:0,commandPercent:0,calculate:2},this.fairResistance={value:0,percent:0,name:"Сопр. (Огонь)",commandValue:0,commandPercent:0,calculate:2},this.deadResistance={value:0,percent:0,name:"Сопр. (Смерть)",commandValue:0,commandPercent:0,calculate:2},this.breakdownOfGeneralProtection={value:0,percent:0,name:"Пробой общей защиты",commandValue:0,commandPercent:0,calculate:2},this.breakdownOfPhysicalProtection={value:0,percent:0,name:"Пробой сопр. физ. урону",commandValue:0,commandPercent:0,calculate:2},this.breakdownOfPoisonProtection={value:0,percent:0,name:"Пробой сопр. яду",commandValue:0,commandPercent:0,calculate:2},this.breakdownOfElectricityProtection={value:0,percent:0,name:"Пробой сопр. электричеству",commandValue:0,commandPercent:0,calculate:2},this.breakdownOfWaterProtection={value:0,percent:0,name:"Пробой сопр. воде",commandValue:0,commandPercent:0,calculate:2},this.breakdownOfFairProtection={value:0,percent:0,name:"Пробой сопр. огню",commandValue:0,commandPercent:0,calculate:2},this.breakdownOfDeadProtection={value:0,percent:0,name:"Пробой сопр. смерти",commandValue:0,commandPercent:0,calculate:2},this.hp={value:0,percent:0,name:"Здоровье",commandValue:0,commandPercent:0,calculate:2},this.damage={value:0,percent:0,name:"Урон",commandValue:0,commandPercent:0,calculate:1}}countSomeParameters(){Object.keys(this).forEach((e=>{this[e].value&&this[e].percent&&(this[e].value+=Math.ceil(this[e].value*this[e].percent/100))})),this.allDamage.value=Object.keys(this).filter((e=>1===this[e].calculate)).reduce(((e,a)=>e+this[a].value),0),this.sum3Parameters.value=this.allDamage.value+this.generalProtection.value+this.shock.value,this.allParameters.value=Object.keys(this).filter((e=>2===this[e].calculate)).reduce(((e,a)=>e+(!this[a].value&&this[a].percent?this[a].percent:this[a].value?this[a].value:0)),0)}}const modifyParameters=e=>{const a=new Etalon;return a.type=e.type,a.complect=e.complect,Object.keys(a).forEach((t=>{t in e&&(0!=e[t].value&&"number"==typeof e[t].value&&(a[t].value=e[t].value),0!=parseInt(e[t].value)&&"string"==typeof e[t].value&&(a[t].percent=parseInt(e[t].value)),0!=e[t].commandValue&&"number"==typeof e[t].commandValue&&(a[t].value+=e[t].commandValue,a[t].commandValue=e[t].commandValue),0!=parseInt(e[t].commandValue)&&"string"==typeof e[t].commandValue&&(a[t].percent+=parseInt(e[t].commandValue),a[t].commandPercent=parseInt(e[t].commandValue)))})),a};onmessage=e=>{const a=[],t=[[],[],[],[],[],[],[],[],[],[]],c=e=>{const a=new Etalon;a.num=[];let t=0,c=0;return e.forEach(((e,n)=>{2==e.complect&&++t,3==e.complect&&++c,Object.keys(e).forEach((t=>{"object"==typeof e[t]&&t in a?(a[t].value+=e[t].value,a[t].percent+=e[t].percent,a[t].commandValue+=e[t].commandValue,a[t].commandPercent+=e[t].commandPercent):"num"===t&&a.num.push(e.num)}))})),t>=3&&(a.damage.value+=3,a.accuracy.value+=2,a.damage.percent+=3,a.damage.commandPercent+=3),c>=3&&(a.damage.percent+=10,a.generalProtection.value+=10,a.hp.value+=130,a.damage.value+=10,a.hp.commandValue+=30),a.countSomeParameters(),a};e.data.forEach(((e,a)=>{const c=modifyParameters(e);c.num=a,t[c.type-1].push(c)}));for(let e=0;e<t[0].length;e++)for(let n=0;n<t[1].length;n++)for(let l=0;l<t[2].length;l++)for(let m=0;m<t[3].length;m++)for(let r=0;r<t[4].length-1;r++)for(let o=r+1;o<t[4].length;o++)for(let u=0;u<t[5].length;u++)for(let s=0;s<t[6].length;s++)for(let d=0;d<t[7].length;d++)for(let i=0;i<t[8].length;i++)a.push(c([t[0][e],t[1][n],t[2][l],t[3][m],t[4][r],t[4][o],t[5][u],t[6][s],t[7][d],t[8][i]]));for(let e=0;e<t[0].length;e++)for(let n=0;n<t[2].length;n++)for(let l=0;l<t[3].length;l++)for(let m=0;m<t[4].length-1;m++)for(let r=m+1;r<t[4].length;r++)for(let o=0;o<t[5].length;o++)for(let u=0;u<t[6].length;u++)for(let s=0;s<t[8].length;s++)for(let d=0;d<t[9].length;d++)a.push(c([t[0][e],t[2][n],t[3][l],t[4][m],t[4][r],t[5][o],t[6][u],t[8][s],t[9][d]]));postMessage(a)};